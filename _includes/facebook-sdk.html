<div id="fb-root"></div><script>
var permissions = null; // stores the permissions the user has granted the app
	window.fbAsyncInit = function() {
	    // init the FB JS SDK
	    FB.init({
	      appId      : '244539232310841',                    // App ID from the app dashboard
	      status     : true,                                 // Check Facebook Login status
	      xfbml      : true                                  // Look for social plugins on the page
	    });
	    // Additional initialization code such as adding Event Listeners goes here
	  };

	  // Load the SDK asynchronously
	  (function(){
	  	if(navigator.onLine){
	     // If we've already installed the SDK, we're done
	     if (document.getElementById('facebook-jssdk')) {return;}
	     // Get the first script element, which we'll use to find the parent node
	     var firstScriptElement = document.getElementsByTagName('script')[0];
	     // Create a new script element and set its id
	     var facebookJS = document.createElement('script');
	     facebookJS.id = 'facebook-jssdk';
	     // Set the new script's source to the source of the Facebook JS SDK
	     facebookJS.src = 'http://connect.facebook.net/en_US/all/debug.js';
	     // Insert the Facebook JS SDK into the DOM
	     firstScriptElement.parentNode.insertBefore(facebookJS, firstScriptElement);
	 }
	}());
	  console.log("subscribing permisions");
	  // Auto login and permissions check
	  FB.Event.subscribe('auth.statusChange', function(rsp){
	  	console.log(rsp);
	  	if(rsp.authResponse){
	  		FB.api('/me/', function(me){
	  			console.log(me);
	  		});
	  	// get the permission's the user has already granted
	  		FB.api('/me/permissions', function(response){
	  			if(response){
	  				console.log(response.data[0]);
	  				permissions = response.data[0];
	  			}
	  		})
	  	}
	  })

function fbShare(permissions){
	if(!permissions || (permissons && !permissions.publish_actions)){
		console.log("user needs to grant publish_actions permission, login or auth this app")
		FB.login(function(rsp){
			FB.api('/me/permissons', function(response){
				console.log(response.data[0]);
				permissions = response.data[0];
			})
			// could re-attempt to publish here, but won't for simplicity
		},{socpe:'publish_actions'})
	} else {
		// all good, lets try an publish an action using the og:url tag as the object.url
		FB.api('/me/news.reads', 'post', {
			"article": "{{ canonical }}"
		}, function(rsp){
			console.log(rsp);
			if(rsp.id) {
				alert('action published with ID: ' + rsp.id);
			}
		})
	}
};

</script>